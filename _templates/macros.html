{# Macros to make the life easier across the website #}


{%- macro youtube_embed(video_id, aspect="16x9") -%}
{# Embed a youtube video on the page given the video ID.
   The ID are the chars after v= in the link. #}
  <div class="ratio ratio-{{ aspect }} mb-3">
    <iframe
     src="https://www.youtube-nocookie.com/embed/{{ video_id }}"
     title="YouTube video player" frameborder="0" allowfullscreen>
    </iframe>
  </div>
{%- endmacro -%}


{%- macro button_link(href, text, type="btn-primary", icon="none") %}
  <a class="btn btn-sm {{ type }} me-1 mb-2" href="{{ href }}" target="_blank">
    <i class="{{ icon }} me-1" aria-hidden="true"></i>
    {{ text }}
  </a>
{%- endmacro %}


{%- macro make_publication_list(publications, base_id) %}
{# Create a list of publications #}
<div class="mt-5">
  {%- for paper in publications %}
    {%- set id = base_id ~ "-" ~ loop.index %}
    {%- if paper.doi is defined %}
      {%- set doi = paper.doi %}
    {%- else %}
      {%- set doi = paper.preprint %}
    {%- endif %}
    {%- if paper.openaccess is defined and paper.openaccess %}
      {%- set pdf = "https://doi.org/" ~ paper.doi %}
    {%- elif paper.preprint is defined %}
      {%- set pdf = "https://doi.org/" ~ paper.preprint %}
    {%- elif paper.pdf is defined %}
      {%- set pdf = paper.pdf %}
    {%- endif %}
    <div class="mb-5">
    <h2 class="fs-4 mb-1">
      {{ paper.title|trim }}
    </h2>
    <p class="mb-1">
      <span class="text-muted">{{ paper.year }} |</span>
      {{ paper.authors|trim }}
    </p>
    <p class="text-muted fs-6">
      {%- if paper.openaccess is defined and paper.openaccess %}
        <span class="badge bg-success fw-normal me-1">
          <i class="ai ai-open-access me-1" aria-hidden="true"></i>
          open-access
        </span>
      {%- endif %}
      {%- if paper.preprint is defined and not paper.doi is defined %}
        <span class="badge bg-warning text-dark fw-normal me-1">
          preprint
        </span>
      {%- endif %}
      {{ paper.journal }},
      doi:<a href="https://doi.org/{{ doi }}">{{ doi }}</a>
    </p>
    <button class="btn btn-secondary btn-sm me-1 mb-2" type="button"
        data-bs-toggle="collapse" data-bs-target="#collapse-abstract-{{ id }}"
        aria-expanded="false" aria-controls="collapse-abstract-{{ id }}">
      Find out more <i class="fa fa-chevron-circle-down ms-1" aria-hidden="true"></i>
    </button>
    {{ button_link(pdf, "PDF", type="btn-primary", icon="fa fa-file-pdf") }}
    {%- if paper.data is defined %}
      {{ button_link("https://doi.org/" ~ paper.data, "Data", type="btn-light", icon="fa fa-chart-bar") }}
    {%- endif %}
    {%- if paper.github is defined %}
      {{ button_link("https://github.com/" ~ paper.github, "Code", type="btn-light", icon="fab fa-github") }}
    {%- endif %}
    <div id="collapse-abstract-{{ id }}" class="collapse paper-info mt-2 overflow-hidden">
      <section class="row gx-5">
        <div class="col-lg-6">
          {%- if paper.note is defined %}
            <div class="callout callout-note mb-4">
              <p><strong>Note:</strong> {{ paper.note|trim }}</p>
            </div>
          {%- endif %}
          <h3 class="fs-4">Abstract</h3>
          <p>{{ paper.abstract|trim }}</p>
        </div>
        <div class="col-lg-6">
          <h3 class="fs-4">Cite as</h3>
          <blockquote class="mb-4">{{ paper.citation|trim }}</blockquote>
          <h3 class="fs-4">BibTex</h3>
          <pre class="mb-4"><code>{{ paper.bibtex|trim|escape }}</code></pre>
          <h3 class="fs-4 mb-4">Citations</h3>
          <span class="__dimensions_badge_embed__" data-doi="{{ doi }}"></span>
        </div>
      </section>
    </div>
    </div>
  {%- endfor %}
</div>
{%- endmacro %}
